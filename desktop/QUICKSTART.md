# Desktop 收银系统 - 快速启动

## ⚡ 一键启动（2 步）

### 1. 配置后端地址

创建 `.env` 文件（复制 `env.example`）:

```bash
# Windows
copy env.example .env

# Linux/Mac
cp env.example .env
```

**编辑 `.env`**:
```env
VITE_API_HOST=localhost
VITE_API_PORT=8000

# 局域网使用（修改为你的后端 IP）
# VITE_API_HOST=192.168.1.100
```

### 2. 启动应用

```bash
# 安装依赖（首次）
npm install

# 启动开发模式
npm run tauri:dev
```

✅ 等待编译完成后会自动打开窗口

---

## 🎯 功能特性

### 界面布局
- **顶部**: 连接状态 + 扫描状态
- **中部**: 购物车列表
- **底部**: 合计 + 操作按钮

### 扫码枪支持
- ✅ 得力扫描枪 HID 键盘模式
- ✅ 自动监听，无需点击输入框
- ✅ 扫码 → 自动查询 → 自动加购

### 购物车管理
- ✅ 同条码自动合并 +1
- ✅ 数量调节（+/-）
- ✅ 多选删除
- ✅ 清空、撤销
- ✅ 实时计算总价

### 订单提交
- ✅ 提交到后端
- ✅ 自动扣库存
- ✅ 生成订单号
- ✅ 成功后清空购物车

---

## 🧪 快速测试

### 1. 确保后端已启动

```bash
cd backend
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### 2. 检查连接状态

打开桌面应用，查看顶部：
- ✅ 绿点 = 已连接
- ❌ 红点 = 未连接（检查后端和配置）

### 3. 测试扫码（键盘输入）

确保窗口焦点在应用上，直接输入：

```
6901028075831<回车>
```

商品应该自动加入购物车。

### 4. 测试操作

- 点击 `+/-` 调整数量
- 勾选商品，点击"删除选中"
- 点击"撤销"删除最后一个
- 点击"清空"清空购物车
- 点击"提交订单"

---

## 📡 后端接口说明

桌面应用会调用以下接口：

1. **查询商品**
   ```
   GET /products/by_barcode?code=6901028075831
   ```

2. **提交订单**
   ```
   POST /orders/create
   ```

3. **WebSocket 连接**
   ```
   ws://localhost:8000/ws
   ```

---

## 🔧 配置说明

### 方式 1: 使用 .env（推荐）

```env
VITE_API_HOST=localhost
VITE_API_PORT=8000
```

### 方式 2: 修改 config.ts

编辑 `src/config.ts`:
```typescript
const API_HOST = "192.168.1.100";  // 改这里
const API_PORT = "8000";
```

---

## 🐛 常见问题

### Q1: 连接状态显示红点？

**检查清单**:
- [ ] 后端是否启动？
- [ ] `.env` 配置是否正确？
- [ ] 防火墙是否允许 8000 端口？

### Q2: 扫码无反应？

**检查清单**:
- [ ] 窗口是否有焦点？（点击窗口任意位置）
- [ ] 扫描枪是否为 HID 键盘模式？
- [ ] 尝试手动输入条码 + 回车

### Q3: 提交订单失败？

**可能原因**:
- 库存不足
- 后端服务未启动
- 网络连接失败

**解决**: 查看错误提示，检查后端日志

---

## 📁 项目文件

| 文件 | 说明 |
|------|------|
| `src/App.tsx` | 主界面代码 |
| `src/App.css` | 样式 |
| `src/config.ts` | 配置（后端地址） |
| `.env` | 环境变量（需手动创建） |
| `env.example` | 配置示例 |
| `DESKTOP_MVP.md` | 详细文档 |

---

## ✨ 使用技巧

1. **扫码即用**: 无需点击输入框，直接扫码
2. **快捷操作**: 键盘输入条码 + 回车
3. **批量删除**: 勾选多个商品后点删除
4. **撤销误操作**: 点击"撤销"删除最后一个

---

**🎉 完成！开始使用收银系统吧！**

详细功能说明请查看 [DESKTOP_MVP.md](./DESKTOP_MVP.md)


